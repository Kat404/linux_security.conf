# Sección 1: Protecciones contra Spoofing y Filtrado de Rutas
# Nota: 
# 0 = Falso
# 1 = Verdadero
# Estas evitan ataques de spoofing IP verificando rutas de paquetes.
# Impacto con VPN: Usa modo 'loose' (2) para compatibilidad con rutas asimétricas (comunes en VPNs como WireGuard/OpenVPN), evitando drops de conexión. Sin VPN: Podrías usar modo estricto (1) para más seguridad, pero loose es un buen balance general.
net.ipv4.conf.default.rp_filter=2
net.ipv4.conf.all.rp_filter=2

# Equivalentes para IPv6 (si IPv6 está activo).
# Impacto: Similar al IPv4; con VPN sobre IPv6, loose previene issues de routing. Sin VPN: Reduce riesgos en redes dual-stack.
net.ipv6.conf.default.rp_filter=2
net.ipv6.conf.all.rp_filter=2

# Sección 2: Protecciones contra Ataques DoS y SYN Floods
# Habilita SYN cookies para manejar floods TCP sin agotar recursos.
# Impacto con VPN: No afecta; mejora resiliencia en túneles VPN expuestos a tráfico malicioso. Sin VPN: Esencial en redes públicas para evitar DoS.
net.ipv4.tcp_syncookies=1

# Ignora broadcasts ICMP (anti-Smurf attack/DoS).
# Impacto: Universal; previene amplificación DoS vía ICMP, compatible con VPN (no interfiere en tunnels).
net.ipv4.icmp_echo_ignore_broadcasts=1

# Ignora respuestas de error ICMP bogus (previene side-channel attacks).
# Impacto: Mejora privacidad; con VPN, evita fugas de info fuera del túnel. Sin VPN: Reduce exposición directa.
net.ipv4.icmp_ignore_bogus_error_responses=1

# Sección 3: Manejo de Redirects ICMP y MITM
# Deshabilita aceptación de redirects ICMP para prevenir MITM (atacante redirige tráfico).
# Impacto con VPN: Seguro, ya que VPNs manejan routing internamente; evita redirects maliciosos fuera del túnel. Sin VPN: Crítico en LANs no confiables.
net.ipv4.conf.all.accept_redirects=0
net.ipv4.conf.default.accept_redirects=0

# Deshabilita envío de redirects ICMP (evita que tu máquina ayude en ataques o revele topología).
# Impacto: No afecta VPN; reduce fingerprinting de red en ambos casos.
net.ipv4.conf.all.send_redirects=0

# Equivalentes para IPv6.
# Impacto: Similar; deshabilita si IPv6 activo, para consistencia con/sin VPN.
net.ipv6.conf.all.accept_redirects=0
net.ipv6.conf.default.accept_redirects=0

# Sección 4: Forwarding y Routing Avanzado
# Deshabilita forwarding IP (tu máquina no actúa como router).
# Impacto con VPN: Para clientes VPN, =0 es ideal (evita forwarding accidental de tráfico VPN); si compartes VPN (raro), =1 con firewall estricto. Sin VPN: Siempre =0 para minimizar riesgos.
net.ipv4.ip_forward=0

# Deshabilita source routing (previene manipulación de rutas por atacantes).
# Impacto: Universal; con VPN, protege el túnel de rutas forzadas. Sin VPN: Evita ataques en redes abiertas.
net.ipv4.conf.all.accept_source_route=0
net.ipv4.conf.default.accept_source_route=0

# Equivalentes para IPv6.
net.ipv6.conf.all.accept_source_route=0
net.ipv6.conf.default.accept_source_route=0

# Sección 5: Logging y Detección
# Logea paquetes 'martians' (inválidos/spoofed).
# Impacto: Aumenta logs para detección; con VPN, ayuda a spotear intentos de spoofing en el túnel. Sin VPN: Útil para monitoreo en journalctl.
net.ipv4.conf.all.log_martians=0

# Sección 6: Protecciones contra Fingerprinting y Optimizaciones TCP
# Deshabilita timestamps TCP (reduce fingerprinting remoto de tu OS/clock).
# Impacto con VPN: Puede causar leve degradación en performance de conexiones TCP largas vía VPN (e.g., descargas); prueba y habilita si issues. Sin VPN: Mejora privacidad en conexiones directas.
net.ipv4.tcp_timestamps=0

# Habilita Selective ACK, D-SACK y FACK (mejora recovery en redes congestionadas, pero en hardening se habilita para eficiencia segura).
# Impacto: Generalmente positivo; con VPN, ayuda en tunnels con pérdida de paquetes. Sin VPN: Optimiza pero no es estrictamente seguridad.
net.ipv4.tcp_sack=1
net.ipv4.tcp_dsack=1
net.ipv4.tcp_fack=1

# Sección 7: Deshabilitar IPv6 si no se usa (reduce superficie de ataque)
# Si no necesitas IPv6 (común en desktops), deshabilítalo completamente.
# Impacto con VPN: Si tu VPN usa IPv6, deja =0; de lo contrario, =1 evita leaks IPv6 fuera del túnel. Sin VPN: =1 cierra vectores innecesarios.
net.ipv6.conf.all.disable_ipv6=0
net.ipv6.conf.default.disable_ipv6=0