# Section 1: Anti-Spoofing and Route Filtering Protections
# Note: 
# 0 = False
# 1 = True
# These prevent IP spoofing attacks by verifying packet routes.
# VPN Impact: Use 'loose' mode (2) for compatibility with asymmetric routes (common in VPNs like WireGuard/OpenVPN), avoiding connection drops. Without VPN: You could use strict mode (1) for more security, but loose is a good general balance.
net.ipv4.conf.default.rp_filter=2
net.ipv4.conf.all.rp_filter=2

# IPv6 equivalents (if IPv6 is active).
# Impact: Similar to IPv4; with VPN over IPv6, loose prevents routing issues. Without VPN: Reduces risks in dual-stack networks.
net.ipv6.conf.default.rp_filter=2
net.ipv6.conf.all.rp_filter=2

# Section 2: DoS and SYN Floods Protection
# Enables SYN cookies to handle TCP floods without exhausting resources.
# VPN Impact: No effect; improves resilience in VPN tunnels exposed to malicious traffic. Without VPN: Essential in public networks to prevent DoS.
net.ipv4.tcp_syncookies=1

# Ignores ICMP broadcasts (anti-Smurf attack/DoS).
# Impact: Universal; prevents DoS amplification via ICMP, VPN compatible (doesn't interfere with tunnels).
net.ipv4.icmp_echo_ignore_broadcasts=1

# Ignores bogus ICMP error responses (prevents side-channel attacks).
# Impact: Enhances privacy; with VPN, prevents info leaks outside the tunnel. Without VPN: Reduces direct exposure.
net.ipv4.icmp_ignore_bogus_error_responses=1

# Section 3: ICMP Redirects and MITM Handling
# Disables ICMP redirects acceptance to prevent MITM (attacker redirecting traffic).
# VPN Impact: Safe, as VPNs handle routing internally; prevents malicious redirects outside the tunnel. Without VPN: Critical in untrusted LANs.
net.ipv4.conf.all.accept_redirects=0
net.ipv4.conf.default.accept_redirects=0

# Disables ICMP redirects sending (prevents your machine from helping in attacks or revealing topology).
# Impact: Doesn't affect VPN; reduces network fingerprinting in both cases.
net.ipv4.conf.all.send_redirects=0

# IPv6 equivalents.
# Impact: Similar; disable if IPv6 is active, for consistency with/without VPN.
net.ipv6.conf.all.accept_redirects=0
net.ipv6.conf.default.accept_redirects=0

# Section 4: Advanced Forwarding and Routing
# Disables IP forwarding (your machine doesn't act as a router).
# VPN Impact: For VPN clients, =0 is ideal (prevents accidental VPN traffic forwarding); if sharing VPN (rare), =1 with strict firewall. Without VPN: Always =0 to minimize risks.
net.ipv4.ip_forward=0

# Disables source routing (prevents route manipulation by attackers).
# Impact: Universal; with VPN, protects tunnel from forced routes. Without VPN: Prevents attacks in open networks.
net.ipv4.conf.all.accept_source_route=0
net.ipv4.conf.default.accept_source_route=0

# IPv6 equivalents.
net.ipv6.conf.all.accept_source_route=0
net.ipv6.conf.default.accept_source_route=0

# Section 5: Logging and Detection
# Logs 'martian' packets (invalid/spoofed).
# Impact: Increases logs for detection; with VPN, helps spot spoofing attempts in the tunnel. Without VPN: Useful for monitoring in journalctl.
net.ipv4.conf.all.log_martians=0

# Section 6: Anti-Fingerprinting and TCP Optimizations
# Disables TCP timestamps (reduces remote OS/clock fingerprinting).
# VPN Impact: May cause slight performance degradation in long TCP connections via VPN (e.g., downloads); test and enable if issues arise. Without VPN: Improves privacy in direct connections.
net.ipv4.tcp_timestamps=0

# Enables Selective ACK, D-SACK, and FACK (improves recovery in congested networks, enabled in hardening for secure efficiency).
# Impact: Generally positive; with VPN, helps in tunnels with packet loss. Without VPN: Optimizes but isn't strictly security.
net.ipv4.tcp_sack=1
net.ipv4.tcp_dsack=1
net.ipv4.tcp_fack=1

# Section 7: Disable IPv6 if unused (reduces attack surface)
# If you don't need IPv6 (common in desktops), disable it completely.
# VPN Impact: If your VPN uses IPv6, leave =0; otherwise, =1 prevents IPv6 leaks outside the tunnel. Without VPN: =1 closes unnecessary vectors.
net.ipv6.conf.all.disable_ipv6=0
net.ipv6.conf.default.disable_ipv6=0